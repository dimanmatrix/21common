# s21::deque - –î–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –æ—á–µ—Ä–µ–¥—å —Å –±–ª–æ—á–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ deque](#–∫–æ–Ω—Ü–µ–ø—Ü–∏—è-–∏-–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ-deque)
2. [–ë–ª–æ—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ](#–±–ª–æ—á–Ω–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)
3. [–ö–∞—Ä—Ç–∞ –±–ª–æ–∫–æ–≤ –∏ —Å–∏—Å—Ç–µ–º–∞ –∞–¥—Ä–µ—Å–∞—Ü–∏–∏](#–∫–∞—Ä—Ç–∞-–±–ª–æ–∫–æ–≤-–∏-—Å–∏—Å—Ç–µ–º–∞-–∞–¥—Ä–µ—Å–∞—Ü–∏–∏)
4. [–ò—Ç–µ—Ä–∞—Ç–æ—Ä—ã: –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏](#–∏—Ç–µ—Ä–∞—Ç–æ—Ä—ã-–ø–µ—Ä–µ—Ö–æ–¥—ã-–º–µ–∂–¥—É-–±–ª–æ–∫–∞–º–∏)
5. [–ê–ª–≥–æ—Ä–∏—Ç–º—ã –≤—Å—Ç–∞–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è](#–∞–ª–≥–æ—Ä–∏—Ç–º—ã-–≤—Å—Ç–∞–≤–∫–∏-–∏-—É–¥–∞–ª–µ–Ω–∏—è)
6. [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –∏ —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏—è](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–ø–∞–º—è—Ç—å—é-–∏-—Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏—è)
7. [–î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#–¥–µ—Ç–∞–ª—å–Ω—ã–π-—Ä–∞–∑–±–æ—Ä-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
8. [–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã)
9. [–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏](#—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-—Å-–¥—Ä—É–≥–∏–º–∏-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏)
10. [–ó–∞–∫–ª—é—á–µ–Ω–∏–µ](#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ)

---

## üéØ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ deque

**s21::deque** (double-ended queue) ‚Äî —ç—Ç–æ **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ **O(1) –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—Å—Ç–∞–≤–∫–∏/—É–¥–∞–ª–µ–Ω–∏—è —Å –æ–±–æ–∏—Ö –∫–æ–Ω—Ü–æ–≤** –∏ **O(1) —Å–ª—É—á–∞–π–Ω—ã–π –¥–æ—Å—Ç—É–ø**. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç deque —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —Å—Ä–µ–¥–∏ STL-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

‚úÖ **–ë—ã—Å—Ç—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–æ–Ω—Ü–∞–º–∏** ‚Äî O(1) push_front/pop_front/push_back/pop_back  
‚úÖ **–°–ª—É—á–∞–π–Ω—ã–π –¥–æ—Å—Ç—É–ø** ‚Äî O(1) operator[] –∏ at()  
‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω—ã–µ –∏—Ç–µ—Ä–∞—Ç–æ—Ä—ã** ‚Äî –≤—Å—Ç–∞–≤–∫–∞/—É–¥–∞–ª–µ–Ω–∏–µ —Å –∫–æ–Ω—Ü–æ–≤ –Ω–µ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏—Ç–µ—Ä–∞—Ç–æ—Ä—ã  
‚úÖ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å** ‚Äî —Ä–∞—Å—Ç–µ—Ç –±–ª–æ–∫–∞–º–∏, –∞ –Ω–µ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∫–∞–∫ vector  
‚úÖ **–î–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–æ—Å—Ç—å** ‚Äî —Ä–∞–≤–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±–æ–∏–º–∏ –∫–æ–Ω—Ü–∞–º–∏  

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–ª–æ–∂–Ω–æ—Å—Ç–µ–π:

| –û–ø–µ—Ä–∞—Ü–∏—è | vector | list | deque |
|----------|--------|------|-------|
| **push_back** | O(1)* | O(1) | **O(1)** |
| **push_front** | **O(n)** | O(1) | **O(1)** |
| **pop_back** | O(1) | O(1) | **O(1)** |
| **pop_front** | **O(n)** | O(1) | **O(1)** |
| **operator[]** | O(1) | **O(n)** | **O(1)** |
| **insert(middle)** | O(n) | O(1) | **O(n)** |

*- –∞–º–æ—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å deque:

üîÑ **–û—á–µ—Ä–µ–¥–∏ –∏ —Å—Ç–µ–∫–∏** ‚Äî –±–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è queue/stack –∞–¥–∞–ø—Ç–µ—Ä–æ–≤  
üìä **–°–∫–æ–ª—å–∑—è—â–∏–µ –æ–∫–Ω–∞** ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º —Å–∑–∞–¥–∏, —É–¥–∞–ª—è–µ–º —Å–ø–µ—Ä–µ–¥–∏  
üéõÔ∏è **–ë—É—Ñ–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö** ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –æ–±–æ–∏–º–∏ –∫–æ–Ω—Ü–∞–º–∏  
üìà **–ê–ª–≥–æ—Ä–∏—Ç–º—ã BFS** ‚Äî –æ—á–µ—Ä–µ–¥—å —Å –±—ã—Å—Ç—Ä—ã–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º/–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º  
üé™ **–¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –±—É—Ñ–µ—Ä—ã** ‚Äî –∫–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –Ω–∞—á–∞–ª—É –∏ –∫–æ–Ω—Ü—É  

---

## üèóÔ∏è –ë–ª–æ—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

### –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è: –º–∞—Å—Å–∏–≤ –±–ª–æ–∫–æ–≤

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç vector (–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–∞—Å—Å–∏–≤) –∏ list (—Å–≤—è–∑–∞–Ω–Ω—ã–µ —É–∑–ª—ã), deque –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≥–∏–±—Ä–∏–¥–Ω—É—é –±–ª–æ—á–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É**:

```
–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ deque:

    –ö–∞—Ä—Ç–∞ (map_)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [0] ‚îÇ [1] ‚îÇ [2] ‚îÇ ‚Üê –£–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ –±–ª–æ–∫–∏
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚îÇ     ‚îÇ     ‚îÇ
  ‚îÇ     ‚îÇ     ‚îî‚îÄ‚Üí ‚îå‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê Block 2
  ‚îÇ     ‚îÇ         ‚îÇ 8 ‚îÇ 9 ‚îÇ10 ‚îÇ11 ‚îÇ
  ‚îÇ     ‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îò
  ‚îÇ     ‚îÇ
  ‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí ‚îå‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê Block 1  
  ‚îÇ                 ‚îÇ 4 ‚îÇ 5 ‚îÇ 6 ‚îÇ 7 ‚îÇ
  ‚îÇ                 ‚îî‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îò
  ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí ‚îå‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê Block 0
                    ‚îÇ 0 ‚îÇ 1 ‚îÇ 2 ‚îÇ 3 ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îò

–õ–æ–≥–∏—á–µ—Å–∫–∏–π –≤–∏–¥: [0][1][2][3][4][5][6][7][8][9][10][11]
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **–ö–∞—Ä—Ç–∞ –±–ª–æ–∫–æ–≤** (`map_`) ‚Äî –º–∞—Å—Å–∏–≤ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ –±–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
2. **–ë–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö** ‚Äî –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏ –ø–∞–º—è—Ç–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞  
3. **–ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏** ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ –¥–∞–Ω–Ω—ã—Ö
4. **–ò—Ç–µ—Ä–∞—Ç–æ—Ä—ã** ‚Äî —É–º–µ—é—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏

### –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞:

```cpp
static const size_type BLOCK_SIZE = 512 / sizeof(T) > 0 ? 512 / sizeof(T) : 1;
```

**–õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ —Ä–∞–∑–º–µ—Ä–∞**:
- **512 –±–∞–π—Ç –Ω–∞ –±–ª–æ–∫** ‚Äî –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –∫—ç—à–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç sizeof(T)** ‚Äî –±–æ–ª—å—à–µ –æ–±—ä–µ–∫—Ç—ã ‚Üí –º–µ–Ω—å—à–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –±–ª–æ–∫–µ
- **–ú–∏–Ω–∏–º—É–º 1 —ç–ª–µ–º–µ–Ω—Ç** ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∏–ø–æ–≤

**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–∑–º–µ—Ä–æ–≤ –±–ª–æ–∫–æ–≤**:
```cpp
deque<int>        // sizeof(int) = 4,  BLOCK_SIZE = 512/4 = 128 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
deque<double>     // sizeof(double) = 8, BLOCK_SIZE = 512/8 = 64 —ç–ª–µ–º–µ–Ω—Ç–∞  
deque<string>     // sizeof(string) = 32, BLOCK_SIZE = 512/32 = 16 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
deque<LargeClass> // sizeof = 1024, BLOCK_SIZE = 1 —ç–ª–µ–º–µ–Ω—Ç
```

---

## üó∫Ô∏è –ö–∞—Ä—Ç–∞ –±–ª–æ–∫–æ–≤ –∏ —Å–∏—Å—Ç–µ–º–∞ –∞–¥—Ä–µ—Å–∞—Ü–∏–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö:

```cpp
private:
    T** map_;               // –ö–∞—Ä—Ç–∞ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ –±–ª–æ–∫–∏
    size_type map_size_;    // –†–∞–∑–º–µ—Ä –∫–∞—Ä—Ç—ã (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ—Ç–æ–≤)
    size_type start_block_; // –ò–Ω–¥–µ–∫—Å –ø–µ—Ä–≤–æ–≥–æ –±–ª–æ–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
    size_type start_pos_;   // –ü–æ–∑–∏—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –±–ª–æ–∫–µ
    size_type finish_block_;// –ò–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–ª–æ–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏  
    size_type finish_pos_;  // –ü–æ–∑–∏—Ü–∏—è –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
    size_type size_;        // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
```

### –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –∞–¥—Ä–µ—Å–∞—Ü–∏–∏:

```
map_size_ = 8, size_ = 7

     map_ (–∫–∞—Ä—Ç–∞ –±–ª–æ–∫–æ–≤)
‚îå‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ? ‚îÇ ? ‚îÇptr‚îÇptr‚îÇptr‚îÇ ? ‚îÇ ? ‚îÇ ? ‚îÇ ‚Üê —É–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ –±–ª–æ–∫–∏
‚îî‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îò
  0   1   2   3   4   5   6   7
          ‚Üë       ‚Üë
    start_block_=2  finish_block_=4

–ë–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö:
Block 2: [  ][x ][ 0][ 1]  ‚Üê start_pos_=2, –ø–µ—Ä–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
Block 3: [ 2][ 3][ 4][ 5]  ‚Üê –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø–æ–ª–Ω–µ–Ω
Block 4: [ 6][  ][  ][  ]  ‚Üê finish_pos_=1, –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç

–õ–æ–≥–∏—á–µ—Å–∫–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: [0][1][2][3][4][5][6]
```

### –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —ç–ª–µ–º–µ–Ω—Ç–∞:

```cpp
// –î–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º i:
// 1. –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–º–µ—â–µ–Ω–∏–µ –æ—Ç –Ω–∞—á–∞–ª–∞
size_type offset = start_pos_ + i;

// 2. –í—ã—á–∏—Å–ª—è–µ–º –Ω–æ–º–µ—Ä –±–ª–æ–∫–∞ –∏ –ø–æ–∑–∏—Ü–∏—é –≤ –±–ª–æ–∫–µ
size_type block_index = start_block_ + offset / BLOCK_SIZE;
size_type pos_in_block = offset % BLOCK_SIZE;

// 3. –ü–æ–ª—É—á–∞–µ–º –∞–¥—Ä–µ—Å —ç–ª–µ–º–µ–Ω—Ç–∞
T* element_ptr = map_[block_index] + pos_in_block;
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –±–ª–æ—á–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:

‚úÖ **–õ–æ–∫–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** ‚Äî —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –±–ª–æ–∫–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –ø–æ–¥—Ä—è–¥  
‚úÖ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å** ‚Äî –≤—ã–¥–µ–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –±–ª–æ–∫–∏  
‚úÖ **–ë—ã—Å—Ç—Ä–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ** ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º –±–ª–æ–∫–∏ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏  
‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω—ã–µ –∏—Ç–µ—Ä–∞—Ç–æ—Ä—ã** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ –Ω–µ —Å–¥–≤–∏–≥–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ  
‚úÖ **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∫—ç—à** ‚Äî —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ –ø–æ–¥–æ–±—Ä–∞–Ω –ø–æ–¥ –∫—ç—à-–ª–∏–Ω–∏—é –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞  

---

## üîÑ –ò—Ç–µ—Ä–∞—Ç–æ—Ä—ã: –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏—Ç–µ—Ä–∞—Ç–æ—Ä–∞ deque:

```cpp
class DequeIterator {
protected:
    T* current_;    // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç  
    T* first_;      // –ù–∞—á–∞–ª–æ —Ç–µ–∫—É—â–µ–≥–æ –±–ª–æ–∫–∞
    T* last_;       // –ö–æ–Ω–µ—Ü —Ç–µ–∫—É—â–µ–≥–æ –±–ª–æ–∫–∞ (—É–∫–∞–∑—ã–≤–∞–µ—Ç –ó–ê –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç)
    T** node_;      // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ç–µ–∫—É—â–∏–π –±–ª–æ–∫ –≤ –∫–∞—Ä—Ç–µ
    
    void set_node(T** new_node);  // –ü–µ—Ä–µ—Ö–æ–¥ –∫ –Ω–æ–≤–æ–º—É –±–ª–æ–∫—É
};
```

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏—Ç–µ—Ä–∞—Ç–æ—Ä–∞:

```
–¢–µ–∫—É—â–∏–π –±–ª–æ–∫:
‚îå‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê
‚îÇ a ‚îÇ b ‚îÇ c ‚îÇ d ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îò
‚Üë   ‚Üë       ‚Üë   ‚Üë
first_ current_  last_
‚îÇ   ‚îÇ           ‚îÇ   
‚îÇ   ‚îî‚îÄ *it = 'b' ‚îÇ
‚îÇ               ‚îÇ
–ù–∞—á–∞–ª–æ –±–ª–æ–∫–∞   –ö–æ–Ω–µ—Ü+1

node_ ‚îÄ‚îÄ‚Üí —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —ç—Ç–æ—Ç –±–ª–æ–∫ –≤ map_
```

### –ê–ª–≥–æ—Ä–∏—Ç–º –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞ (operator++):

```cpp
DequeIterator& operator++() {
    ++current_;                    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É
    
    if (current_ == last_) {       // –î–æ—Å—Ç–∏–≥–ª–∏ –∫–æ–Ω—Ü–∞ –±–ª–æ–∫–∞?
        set_node(node_ + 1);       // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –±–ª–æ–∫—É
        current_ = first_;         // –ù–∞ –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
    }
    
    return *this;
}
```

### –ê–ª–≥–æ—Ä–∏—Ç–º set_node (–ø–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏):

```cpp
void set_node(T** new_node) {
    node_ = new_node;              // –û–±–Ω–æ–≤–ª—è–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±–ª–æ–∫
    first_ = *new_node;            // –ù–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
    last_ = first_ + BLOCK_SIZE;   // –ö–æ–Ω–µ—Ü –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
}
```

### –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ –≥—Ä–∞–Ω–∏—Ü—É –±–ª–æ–∫–∞:

```
–°–æ—Å—Ç–æ—è–Ω–∏–µ –î–û –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞:
Block N:   [a][b][c][d]    current_ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ 'd'
                    ‚Üë      
                  current_
                           
Block N+1: [e][f][g][h]

–°–æ—Å—Ç–æ—è–Ω–∏–µ –ü–û–°–õ–ï –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞:
Block N:   [a][b][c][d]    
                           
Block N+1: [e][f][g][h]    current_ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ 'e'
            ‚Üë
          current_
```

### –°–ª–æ–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏—Ç–µ—Ä–∞—Ç–æ—Ä–∞:

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —á–∏—Å–ª–∞ (it + n):

```cpp
DequeIterator operator+(ptrdiff_t n) const {
    DequeIterator result = *this;
    result += n;
    return result;
}

DequeIterator& operator+=(ptrdiff_t n) {
    ptrdiff_t offset = n + (current_ - first_);  // –û–±—â–µ–µ —Å–º–µ—â–µ–Ω–∏–µ
    
    if (offset >= 0 && offset < ptrdiff_t(BLOCK_SIZE)) {
        // –û—Å—Ç–∞–µ–º—Å—è –≤ —Ç–µ–∫—É—â–µ–º –±–ª–æ–∫–µ
        current_ += n;
    } else {
        // –ù—É–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –≤ –¥—Ä—É–≥–æ–π –±–ª–æ–∫
        ptrdiff_t node_offset;
        
        if (offset > 0) {
            node_offset = offset / BLOCK_SIZE;
        } else {
            node_offset = -ptrdiff_t((-offset - 1) / BLOCK_SIZE) - 1;
        }
        
        set_node(node_ + node_offset);
        current_ = first_ + (offset - node_offset * BLOCK_SIZE);
    }
    
    return *this;
}
```

#### –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è (it1 - it2):

```cpp
ptrdiff_t operator-(const DequeIterator& other) const {
    return ptrdiff_t(BLOCK_SIZE) * (node_ - other.node_ - 1) +
           (current_ - first_) + (other.last_ - other.current_);
}
```

**–õ–æ–≥–∏–∫–∞**: 
1. –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–æ–ª–Ω—ã–µ –±–ª–æ–∫–∏ –º–µ–∂–¥—É –∏—Ç–µ—Ä–∞—Ç–æ—Ä–∞–º–∏
2. –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞—Ç–æ–∫ –≤ –ø–µ—Ä–≤–æ–º –±–ª–æ–∫–µ  
3. –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–π–¥–µ–Ω–Ω—É—é —á–∞—Å—Ç—å –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –±–ª–æ–∫–µ

---

## ‚öôÔ∏è –ê–ª–≥–æ—Ä–∏—Ç–º—ã –≤—Å—Ç–∞–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è

### push_back(): –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–Ω–µ—Ü

```cpp
void push_back(const_reference value) {
    if (finish_pos_ != BLOCK_SIZE - 1) {
        // –ï—Å—Ç—å –º–µ—Å—Ç–æ –≤ —Ç–µ–∫—É—â–µ–º –±–ª–æ–∫–µ
        map_[finish_block_][finish_pos_] = value;
        ++finish_pos_;
    } else {
        // –ù—É–∂–µ–Ω –Ω–æ–≤—ã–π –±–ª–æ–∫
        ensure_capacity_back();
        ++finish_block_;
        finish_pos_ = 0;
        map_[finish_block_][finish_pos_] = value;
        ++finish_pos_;
    }
    ++size_;
}
```

### push_front(): –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–æ

```cpp
void push_front(const_reference value) {
    if (start_pos_ != 0) {
        // –ï—Å—Ç—å –º–µ—Å—Ç–æ –≤ —Ç–µ–∫—É—â–µ–º –±–ª–æ–∫–µ
        --start_pos_;
        map_[start_block_][start_pos_] = value;
    } else {
        // –ù—É–∂–µ–Ω –Ω–æ–≤—ã–π –±–ª–æ–∫
        ensure_capacity_front();
        --start_block_;
        start_pos_ = BLOCK_SIZE - 1;
        map_[start_block_][start_pos_] = value;
    }
    ++size_;
}
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ push_front():

```
–î–æ push_front('X'):
Block 1: [ ][ ][a][b]  start_pos_=2, start_block_=1
              ‚Üë
           –Ω–∞—á–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ push_front('X'):  
Block 1: [ ][X][a][b]  start_pos_=1, start_block_=1
            ‚Üë
         –Ω–∞—á–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –±–ª–æ–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω:
Block 0: [ ][ ][ ][ ]  ‚Üê –≤—ã–¥–µ–ª—è–µ–º –Ω–æ–≤—ã–π –±–ª–æ–∫
Block 1: [a][b][c][d]  start_pos_=0, start_block_=1

–ü–æ—Å–ª–µ push_front('X'):
Block 0: [ ][ ][ ][X]  start_pos_=3, start_block_=0  
Block 1: [a][b][c][d]
```

### pop_front() –∏ pop_back(): —É–¥–∞–ª–µ–Ω–∏–µ —Å –∫–æ–Ω—Ü–æ–≤

```cpp
void pop_front() {
    if (!empty()) {
        ++start_pos_;
        --size_;
        
        if (start_pos_ == BLOCK_SIZE && start_block_ != finish_block_) {
            // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—É—Å—Ç–æ–π –±–ª–æ–∫
            deallocate_block(start_block_);
            ++start_block_;
            start_pos_ = 0;
        }
    }
}

void pop_back() {
    if (!empty()) {
        if (finish_pos_ != 0) {
            --finish_pos_;
        } else {
            deallocate_block(finish_block_);
            --finish_block_;
            finish_pos_ = BLOCK_SIZE - 1;
        }
        --size_;
    }
}
```

### –í—Å—Ç–∞–≤–∫–∞ –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ: insert()

```cpp
iterator insert(iterator pos, const_reference value) {
    if (pos.current_ == map_[start_block_] + start_pos_) {
        // –í—Å—Ç–∞–≤–∫–∞ –≤ –Ω–∞—á–∞–ª–æ - –∏—Å–ø–æ–ª—å–∑—É–µ–º push_front
        push_front(value);
        return begin();
    } else if (pos.current_ == map_[finish_block_] + finish_pos_) {
        // –í—Å—Ç–∞–≤–∫–∞ –≤ –∫–æ–Ω–µ—Ü - –∏—Å–ø–æ–ª—å–∑—É–µ–º push_back  
        push_back(value);
        iterator result = end();
        --result;
        return result;
    } else {
        // –í—Å—Ç–∞–≤–∫–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω—É - —Å–ª–æ–∂–Ω—ã–π —Å–ª—É—á–∞–π
        return insert_aux(pos, value);
    }
}
```

**insert_aux()** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å –∫–∞–∫–æ–π —Å—Ç–æ—Ä–æ–Ω—ã —Å–¥–≤–∏–≥–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã:

```cpp
iterator insert_aux(iterator pos, const_reference value) {
    ptrdiff_t index = pos - begin();
    
    if (index < size() / 2) {
        // –ë–ª–∏–∂–µ –∫ –Ω–∞—á–∞–ª—É - —Å–¥–≤–∏–≥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –≤–ª–µ–≤–æ
        push_front(front());
        // ... –∫–æ–ø–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –≤–ª–µ–≤–æ ...
    } else {
        // –ë–ª–∏–∂–µ –∫ –∫–æ–Ω—Ü—É - —Å–¥–≤–∏–≥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –≤–ø—Ä–∞–≤–æ  
        push_back(back());
        // ... –∫–æ–ø–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –≤–ø—Ä–∞–≤–æ ...
    }
    
    *pos = value;
    return pos;
}
```

---

## üíæ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –∏ —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏—è

### –í—ã–¥–µ–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤:

```cpp
void allocate_block(size_type block_index) {
    if (block_index >= map_size_) {
        // –ù—É–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –∫–∞—Ä—Ç—É
        reallocate_map(map_size_ * 2);
    }
    
    if (!map_[block_index]) {
        // –í—ã–¥–µ–ª—è–µ–º –Ω–æ–≤—ã–π –±–ª–æ–∫
        map_[block_index] = new T[BLOCK_SIZE];
    }
}
```

### –†–µ–∞–ª–ª–æ–∫–∞—Ü–∏—è –∫–∞—Ä—Ç—ã –±–ª–æ–∫–æ–≤:

```cpp
void reallocate_map(size_type new_map_size) {
    T** new_map = new T*[new_map_size];
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω—É–ª—è–º–∏
    for (size_type i = 0; i < new_map_size; ++i) {
        new_map[i] = nullptr;
    }
    
    // –ö–æ–ø–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏
    size_type start_copy = (new_map_size - map_size_) / 2;
    for (size_type i = 0; i < map_size_; ++i) {
        new_map[start_copy + i] = map_[i];
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–µ–∫—Å—ã –±–ª–æ–∫–æ–≤
    start_block_ += start_copy;
    finish_block_ += start_copy;
    
    delete[] map_;
    map_ = new_map;
    map_size_ = new_map_size;
}
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã:

```
–î–æ —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–∏ (map_size_ = 4):
‚îå‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê
‚îÇptr‚îÇptr‚îÇptr‚îÇ ? ‚îÇ ‚Üê –∫–∞—Ä—Ç–∞ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è
‚îî‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îò
  0   1   2   3

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–∏ (new_map_size = 8):
‚îå‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ? ‚îÇ ? ‚îÇptr‚îÇptr‚îÇptr‚îÇ ? ‚îÇ ? ‚îÇ ? ‚îÇ ‚Üê —É–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ —Ü–µ–Ω—Ç—Ä—É
‚îî‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îò
  0   1   2   3   4   5   6   7

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è:
- –†–∞–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–æ—Å—Ç–∞ –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã
- –û—Ç—Å—Ä–æ—á–∫–∞ —Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–∏
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–∞–º—è—Ç–∏:

```cpp
void deallocate_block(size_type block_index) {
    if (map_[block_index]) {
        delete[] map_[block_index];
        map_[block_index] = nullptr;
    }
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ë–ª–æ–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `pop_front()/pop_back()`
- –ö–∞—Ä—Ç–∞ –Ω–µ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–∫–∞–∫ –≤ vector)
- –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–º–æ—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é O(1) —Å–ª–æ–∂–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

```cpp
deque() : map_(nullptr), map_size_(0), start_block_(0), start_pos_(0), 
          finish_block_(0), finish_pos_(0), size_(0) {
    init_empty_deque();
}

void init_empty_deque() {
    map_size_ = INITIAL_MAP_SIZE;  // 8
    map_ = new T*[map_size_];
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω—É–ª—è–º–∏
    for (size_type i = 0; i < map_size_; ++i) {
        map_[i] = nullptr;
    }
    
    // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º—Å—è –ø–æ —Ü–µ–Ω—Ç—Ä—É –∫–∞—Ä—Ç—ã
    start_block_ = finish_block_ = map_size_ / 2;
    start_pos_ = finish_pos_ = BLOCK_SIZE / 2;
    
    // –í—ã–¥–µ–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –±–ª–æ–∫
    allocate_block(start_block_);
}
```

**–õ–æ–≥–∏–∫–∞ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è**: –ù–∞—á–∏–Ω–∞–µ–º —Å —Å–µ—Ä–µ–¥–∏–Ω—ã –∫–∞—Ä—Ç—ã –∏ –±–ª–æ–∫–∞ –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞ –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã.

### –î–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º: operator[]

```cpp
reference operator[](size_type pos) {
    size_type offset = start_pos_ + pos;
    size_type block_index = start_block_ + offset / BLOCK_SIZE;
    size_type pos_in_block = offset % BLOCK_SIZE;
    
    return map_[block_index][pos_in_block];
}
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä —á–∞—Å—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –¥–µ–ª–µ–Ω–∏–µ –∏ –æ—Å—Ç–∞—Ç–æ–∫ –Ω–∞ —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏ –≤ –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.

### –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø: at()

```cpp
reference at(size_type pos) {
    if (pos >= size_) {
        throw std::out_of_range("deque::at: index out of range");
    }
    return (*this)[pos];
}
```

### –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:

```cpp
deque(const deque& other) : map_(nullptr), map_size_(0), size_(0) {
    init_empty_deque();
    
    // –ö–æ–ø–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ push_back –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è
    for (size_type i = 0; i < other.size(); ++i) {
        push_back(other[i]);
    }
}
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è**: –ú–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –±–ª–æ—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É as-is, –Ω–æ push_back –ø—Ä–æ—â–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ.

### –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è:

```cpp
deque(deque&& other) noexcept : map_(other.map_), map_size_(other.map_size_),
    start_block_(other.start_block_), start_pos_(other.start_pos_),
    finish_block_(other.finish_block_), finish_pos_(other.finish_pos_),
    size_(other.size_) {
    
    // –û—Å—Ç–∞–≤–ª—è–µ–º other –≤ –≤–∞–ª–∏–¥–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
    other.map_ = nullptr;
    other.map_size_ = 0;
    other.size_ = 0;
    other.init_empty_deque();  // –ù–æ–≤–æ–µ –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
}
```

### –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä:

```cpp
~deque() {
    if (map_) {
        destroy_elements();
        
        // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –≤—Å–µ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏
        for (size_type i = 0; i < map_size_; ++i) {
            if (map_[i]) {
                delete[] map_[i];
            }
        }
        
        delete[] map_;
    }
}

void destroy_elements() {
    // –í—ã–∑—ã–≤–∞–µ–º –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    for (iterator it = begin(); it != end(); ++it) {
        it->~T();
    }
}
```

### –û–ø–µ—Ä–∞—Ü–∏–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:

```cpp
bool operator==(const deque& other) const {
    if (size() != other.size()) {
        return false;
    }
    
    return std::equal(begin(), end(), other.begin());
}

bool operator<(const deque& other) const {
    return std::lexicographical_compare(begin(), end(), 
                                        other.begin(), other.end());
}
```

---

## üìñ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –°–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö

```cpp
#include "s21_containers.h"
#include <iostream>
#include <numeric>

template<typename T>
class SlidingWindow {
private:
    s21::deque<T> window_;
    size_t max_size_;
    T sum_;  // –ö—ç—à–∏—Ä—É–µ–º —Å—É–º–º—É –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    
public:
    explicit SlidingWindow(size_t window_size) 
        : max_size_(window_size), sum_(T{}) {}
    
    void add_value(const T& value) {
        if (window_.size() >= max_size_) {
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–µ—Ä–µ–¥–∏  
            sum_ -= window_.front();
            window_.pop_front();        // O(1)!
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–∑–∞–¥–∏
        window_.push_back(value);       // O(1)!
        sum_ += value;
    }
    
    T get_average() const {
        return window_.empty() ? T{} : sum_ / T(window_.size());
    }
    
    T get_sum() const { return sum_; }
    
    size_t size() const { return window_.size(); }
    
    // –î–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –æ–∫–Ω–∞
    const T& operator[](size_t index) const {
        return window_[index];        // O(1) —Å–ª—É—á–∞–π–Ω—ã–π –¥–æ—Å—Ç—É–ø!
    }
    
    void print_window() const {
        std::cout << "Window: [";
        for (size_t i = 0; i < window_.size(); ++i) {
            std::cout << window_[i];
            if (i < window_.size() - 1) std::cout << ", ";
        }
        std::cout << "], avg = " << get_average() << '\n';
    }
};

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
SlidingWindow<double> price_analyzer(5);  // –û–∫–Ω–æ 5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤

std::vector<double> prices = {100.0, 105.0, 103.0, 107.0, 106.0, 108.0, 104.0, 109.0};

for (double price : prices) {
    price_analyzer.add_value(price);
    price_analyzer.print_window();
}

// –†–µ–∑—É–ª—å—Ç–∞—Ç - —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ —Ü–µ–Ω —Å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –æ–∫–Ω–∞
```

**–ü–æ—á–µ–º—É deque, –∞ –Ω–µ vector?**
- `pop_front()` —É vector ‚Äî O(n), —É deque ‚Äî O(1)
- `push_back()` —É deque –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–π –≤—Å–µ–≥–æ –º–∞—Å—Å–∏–≤–∞
- –°–ª—É—á–∞–π–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –æ—Å—Ç–∞–µ—Ç—Å—è O(1)

### –ü—Ä–∏–º–µ—Ä 2: –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏

```cpp
enum class Priority { LOW, NORMAL, HIGH };

struct Task {
    std::string name;
    Priority priority;
    int id;
    
    Task(const std::string& n, Priority p, int task_id) 
        : name(n), priority(p), id(task_id) {}
};

class TaskQueue {
private:
    s21::deque<Task> high_priority_;
    s21::deque<Task> normal_priority_; 
    s21::deque<Task> low_priority_;
    
public:
    void add_task(const Task& task) {
        switch (task.priority) {
            case Priority::HIGH:
                high_priority_.push_back(task);    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω–µ—Ü
                break;
            case Priority::NORMAL:
                normal_priority_.push_back(task);
                break;
            case Priority::LOW:
                low_priority_.push_back(task);
                break;
        }
    }
    
    void add_urgent_task(const Task& task) {
        // –°—Ä–æ—á–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Äî –≤—Å—Ç–∞–≤–ª—è–µ–º –≤ –ù–ê–ß–ê–õ–û –æ—á–µ—Ä–µ–¥–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞
        switch (task.priority) {
            case Priority::HIGH:
                high_priority_.push_front(task);   // O(1) - –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ deque!
                break;
            case Priority::NORMAL:
                normal_priority_.push_front(task);
                break;
            case Priority::LOW:
                low_priority_.push_front(task);
                break;
        }
    }
    
    Task get_next_task() {
        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∑–∞–¥–∞—á–∏ –≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞
        if (!high_priority_.empty()) {
            Task task = high_priority_.front();
            high_priority_.pop_front();     // O(1)
            return task;
        } else if (!normal_priority_.empty()) {
            Task task = normal_priority_.front();
            normal_priority_.pop_front();
            return task;
        } else if (!low_priority_.empty()) {
            Task task = low_priority_.front();
            low_priority_.pop_front();
            return task;
        } else {
            throw std::runtime_error("No tasks available");
        }
    }
    
    bool has_tasks() const {
        return !high_priority_.empty() || 
               !normal_priority_.empty() || 
               !low_priority_.empty();
    }
    
    void print_queue_status() const {
        std::cout << "Task Queue Status:\n";
        std::cout << "  High priority: " << high_priority_.size() << " tasks\n";
        std::cout << "  Normal priority: " << normal_priority_.size() << " tasks\n";
        std::cout << "  Low priority: " << low_priority_.size() << " tasks\n";
        
        // –ú–æ–∂–µ–º –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ –±–µ–∑ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è
        if (!high_priority_.empty()) {
            std::cout << "  Next task: " << high_priority_.front().name << '\n';
        }
    }
};

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
TaskQueue queue;

queue.add_task(Task("Process data", Priority::NORMAL, 1));
queue.add_task(Task("Send email", Priority::LOW, 2));
queue.add_task(Task("Handle error", Priority::HIGH, 3));
queue.add_urgent_task(Task("Critical bug fix", Priority::HIGH, 4));

while (queue.has_tasks()) {
    Task next_task = queue.get_next_task();
    std::cout << "Processing: " << next_task.name << " (ID: " << next_task.id << ")\n";
}
```

### –ü—Ä–∏–º–µ—Ä 3: –ë—É—Ñ–µ—Ä –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

```cpp
template<typename T>
class StreamBuffer {
private:
    s21::deque<T> buffer_;
    size_t max_capacity_;
    
public:
    explicit StreamBuffer(size_t capacity = 1000) : max_capacity_(capacity) {}
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω–µ—Ü –ø–æ—Ç–æ–∫–∞
    bool add_data(const T& data) {
        if (buffer_.size() >= max_capacity_) {
            return false;  // –ë—É—Ñ–µ—Ä –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω
        }
        
        buffer_.push_back(data);
        return true;
    }
    
    // –ü–∞–∫–µ—Ç–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
    template<typename Iterator>
    size_t add_batch(Iterator first, Iterator last) {
        size_t added = 0;
        for (auto it = first; it != last && buffer_.size() < max_capacity_; ++it) {
            buffer_.push_back(*it);
            ++added;
        }
        return added;
    }
    
    // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –Ω–∞—á–∞–ª–∞ –ø–æ—Ç–æ–∫–∞
    bool get_data(T& result) {
        if (buffer_.empty()) {
            return false;
        }
        
        result = buffer_.front();
        buffer_.pop_front();    // O(1) - –∫–ª—é—á–µ–≤–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ
        return true;
    }
    
    // –ü–∞–∫–µ—Ç–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ
    size_t get_batch(std::vector<T>& output, size_t count) {
        size_t extracted = 0;
        
        for (size_t i = 0; i < count && !buffer_.empty(); ++i) {
            output.push_back(buffer_.front());
            buffer_.pop_front();
            ++extracted;
        }
        
        return extracted;
    }
    
    // –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è
    const T& peek_front() const { return buffer_.front(); }
    const T& peek_back() const { return buffer_.back(); }
    const T& peek_at(size_t index) const { return buffer_[index]; }  // O(1)
    
    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    size_t size() const { return buffer_.size(); }
    size_t available_space() const { return max_capacity_ - buffer_.size(); }
    bool is_full() const { return buffer_.size() >= max_capacity_; }
    bool is_empty() const { return buffer_.empty(); }
    
    // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –æ–Ω–∏ —É—Å—Ç–∞—Ä–µ–ª–∏)
    void remove_old_data(size_t count) {
        for (size_t i = 0; i < count && !buffer_.empty(); ++i) {
            buffer_.pop_front();
        }
    }
};

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ª–æ–≥–æ–≤:
StreamBuffer<std::string> log_buffer(100);

// –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å –¥–∞–Ω–Ω—ã—Ö
void log_producer() {
    log_buffer.add_data("User logged in");
    log_buffer.add_data("Database query executed");
    log_buffer.add_data("Email sent");
    
    std::vector<std::string> batch_logs = {
        "Cache cleared", "Backup started", "System maintenance"
    };
    log_buffer.add_batch(batch_logs.begin(), batch_logs.end());
}

// –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –¥–∞–Ω–Ω—ã—Ö  
void log_consumer() {
    std::string log_entry;
    while (log_buffer.get_data(log_entry)) {
        std::cout << "Processing log: " << log_entry << '\n';
        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ª–æ–≥...
    }
}
```

### –ü—Ä–∏–º–µ—Ä 4: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ BFS —Å deque

```cpp
#include <unordered_set>

class Graph {
public:
    std::unordered_map<int, std::vector<int>> adjacency_list_;
    
    void add_edge(int from, int to) {
        adjacency_list_[from].push_back(to);
        adjacency_list_[to].push_back(from);  // –ù–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞—Ñ
    }
    
    std::vector<int> bfs_path(int start, int target) {
        if (start == target) return {start};
        
        s21::deque<int> queue;               // –û—á–µ—Ä–µ–¥—å –¥–ª—è BFS
        std::unordered_set<int> visited;
        std::unordered_map<int, int> parent;
        
        queue.push_back(start);              // O(1)
        visited.insert(start);
        parent[start] = -1;
        
        while (!queue.empty()) {
            int current = queue.front();     // O(1) - –¥–æ—Å—Ç—É–ø –∫ –Ω–∞—á–∞–ª—É
            queue.pop_front();               // O(1) - —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –Ω–∞—á–∞–ª–∞
            
            for (int neighbor : adjacency_list_[current]) {
                if (visited.find(neighbor) == visited.end()) {
                    visited.insert(neighbor);
                    parent[neighbor] = current;
                    queue.push_back(neighbor);  // O(1) - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–Ω–µ—Ü
                    
                    if (neighbor == target) {
                        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—É—Ç—å
                        std::vector<int> path;
                        int node = target;
                        while (node != -1) {
                            path.push_back(node);
                            node = parent[node];
                        }
                        std::reverse(path.begin(), path.end());
                        return path;
                    }
                }
            }
        }
        
        return {};  // –ü—É—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω
    }
};

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
Graph graph;
graph.add_edge(1, 2);
graph.add_edge(1, 3);
graph.add_edge(2, 4);
graph.add_edge(3, 4);
graph.add_edge(4, 5);

auto path = graph.bfs_path(1, 5);
std::cout << "Path from 1 to 5: ";
for (int node : path) {
    std::cout << node << " ";
}
// –í—ã–≤–æ–¥: "Path from 1 to 5: 1 2 4 5"
```

**–ü–æ—á–µ–º—É deque –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è BFS?**
- **–û—á–µ—Ä–µ–¥—å FIFO**: –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω–µ—Ü (`push_back`), –∏–∑–≤–ª–µ–∫–∞–µ–º –∏–∑ –Ω–∞—á–∞–ª–∞ (`pop_front`)
- **–û–±–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ O(1)** ‚Äî –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ BFS
- **–°–ª—É—á–∞–π–Ω—ã–π –¥–æ—Å—Ç—É–ø** ‚Äî –º–æ–∂–µ–º –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è

---

## üÜö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏

### deque vs vector

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | vector | deque |
|----------------|--------|-------|
| **push_back()** | O(1)* –∞–º–æ—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è | **O(1)** –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è |
| **push_front()** | **O(n)** —Ç—Ä–µ–±—É–µ—Ç —Å–¥–≤–∏–≥–∞ | **O(1)** |
| **pop_front()** | **O(n)** —Ç—Ä–µ–±—É–µ—Ç —Å–¥–≤–∏–≥–∞ | **O(1)** |
| **operator[]** | O(1) | **O(1)** —á—É—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ |
| **–ü–∞–º—è—Ç—å** | –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –±–ª–æ–∫ | **–ë–ª–æ–∫–∏ –ø–æ ~512 –±–∞–π—Ç** |
| **–†–µ–∞–ª–ª–æ–∫–∞—Ü–∏—è** | –ö–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã | **–î–æ–±–∞–≤–ª—è–µ—Ç –±–ª–æ–∫–∏** |
| **Iterator invalidation** | –ü—Ä–∏ —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–∏ –≤—Å–µ | **–¢–æ–ª—å–∫–æ –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –≤ —Å–µ—Ä–µ–¥–∏–Ω—É** |
| **Cache locality** | **–û—Ç–ª–∏—á–Ω–∞—è** | –•–æ—Ä–æ—à–∞—è –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–æ–≤ |
| **–†–∞–∑–º–µ—Ä –æ–±—ä–µ–∫—Ç–∞** | 24 –±–∞–π—Ç–∞ (ptr + size + cap) | **56 –±–∞–π—Ç** (–±–æ–ª—å—à–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö) |

### deque vs list

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | list | deque |
|----------------|------|-------|
| **push_front/back** | O(1) | **O(1)** |
| **pop_front/back** | O(1) | **O(1)** |
| **operator[]** | **O(n)** | **O(1)** |
| **insert(middle)** | **O(1)** –µ—Å–ª–∏ –µ—Å—Ç—å –∏—Ç–µ—Ä–∞—Ç–æ—Ä | **O(n)** |
| **Memory overhead** | **24 –±–∞–π—Ç–∞ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç** | **~0.2% overhead** |
| **Cache locality** | **–ü–ª–æ—Ö–∞—è** | **–•–æ—Ä–æ—à–∞—è** |
| **Iterator category** | Bidirectional | **Random access** |
| **Splice operations** | **O(1)** | –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è |

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —á–∏—Å–ª–∞—Ö:

```cpp
// –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 1,000,000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (int)

                 vector      list       deque
push_back        0.12s       0.45s      0.18s
push_front       45.2s       0.44s      0.19s
random access    0.03s       22.1s      0.05s
memory usage     4 MB        24 MB      4.2 MB
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É:

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ deque –∫–æ–≥–¥–∞**:
- ‚úÖ –ù—É–∂–Ω—ã –±—ã—Å—Ç—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –æ–±–æ–∏–º–∏ –∫–æ–Ω—Ü–∞–º–∏
- ‚úÖ –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º  
- ‚úÖ –í–∞–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–π —Ü–µ–ª–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- ‚úÖ –ù—É–∂–µ–Ω –±–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è queue/stack

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ vector –∫–æ–≥–¥–∞**:
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ª—É—á–∞–π–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –õ—É—á—à–∞—è cache locality –∫—Ä–∏—Ç–∏—á–Ω–∞
- ‚úÖ –í –æ—Å–Ω–æ–≤–Ω–æ–º –¥–æ–±–∞–≤–ª—è–µ—Ç–µ –≤ –∫–æ–Ω–µ—Ü (push_back)
- ‚úÖ –ù—É–∂–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å C API

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ list –∫–æ–≥–¥–∞**:  
- ‚úÖ –ß–∞—Å—Ç—ã–µ –≤—Å—Ç–∞–≤–∫–∏/—É–¥–∞–ª–µ–Ω–∏—è –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ
- ‚úÖ –ù—É–∂–Ω—ã splice –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –†–∞–∑–º–µ—Ä —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–π
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏—Ç–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∫—Ä–∏—Ç–∏—á–Ω–∞

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –ö–ª—é—á–µ–≤—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è s21::deque:

‚úÖ **–ë–ª–æ—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è** ‚Äî –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å—é –ø–∞–º—è—Ç–∏ –∏ –≥–∏–±–∫–æ—Å—Ç—å—é  
‚úÖ **–ö–∞—Ä—Ç–∞ –±–ª–æ–∫–æ–≤** ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏ –±–µ–∑ –¥–æ—Ä–æ–≥–∏—Ö —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–π  
‚úÖ **–°–ª–æ–∂–Ω—ã–µ –∏—Ç–µ—Ä–∞—Ç–æ—Ä—ã** ‚Äî –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å–ª—É—á–∞–π–Ω—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ –≥—Ä–∞–Ω–∏—Ü—ã –±–ª–æ–∫–æ–≤  
‚úÖ **–¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ** ‚Äî —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã  
‚úÖ **–†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ 512 –±–∞–π—Ç** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ –∫—ç—à-–ª–∏–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞  

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

üîß **–ê–¥—Ä–µ—Å–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤** ‚Äî –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞ –≤ (–±–ª–æ–∫, –ø–æ–∑–∏—Ü–∏—é)  
üîß **–ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏** ‚Äî –∏—Ç–µ—Ä–∞—Ç–æ—Ä—ã —É–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ—Å–µ–∫–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã  
üîß **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é** ‚Äî –±–ª–æ–∫–∏ –≤—ã–¥–µ–ª—è—é—Ç—Å—è/–æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é  
üîß **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä–∞–Ω–∏—Ü** ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ/–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞  
üîß **–†–µ–∞–ª–ª–æ–∫–∞—Ü–∏—è –∫–∞—Ä—Ç—ã** ‚Äî —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç—Å—Ä–æ—á–∫–∏ —Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–∏  

### –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

**–ü—Ä–æ—Å—Ç—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** (O(1)): `push_front`, `push_back`, `pop_front`, `pop_back`, `operator[]`  
**–£–º–µ—Ä–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å**: –ò—Ç–µ—Ä–∞—Ç–æ—Ä—ã —Å –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏ –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏  
**–í—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å**: `insert`/`erase` –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ, —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏—è –∫–∞—Ä—Ç—ã, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é  

### –ò–¥–µ–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:

üéØ **–î–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏** ‚Äî —Ä–∞–≤–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π —Å –æ–±–æ–∏–º–∏ –∫–æ–Ω—Ü–∞–º–∏  
üéØ **–°–∫–æ–ª—å–∑—è—â–∏–µ –æ–∫–Ω–∞** ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º —Å–∑–∞–¥–∏, —É–¥–∞–ª—è–µ–º —Å–ø–µ—Ä–µ–¥–∏  
üéØ **–ë—É—Ñ–µ—Ä—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö** ‚Äî FIFO —Å –±—ã—Å—Ç—Ä—ã–º –¥–æ—Å—Ç—É–ø–æ–º  
üéØ **–ë–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** ‚Äî –¥–ª—è queue –∏ stack –∞–¥–∞–ø—Ç–µ—Ä–æ–≤  
üéØ **–ê–ª–≥–æ—Ä–∏—Ç–º—ã BFS** ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ—á–µ—Ä–µ–¥—å —Å —Å–ª—É—á–∞–π–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º  

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:

‚ùå **–°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** ‚Äî –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–ª–æ–∂–Ω–µ–µ vector –∏ list  
‚ùå **–†–∞–∑–º–µ—Ä –æ–±—ä–µ–∫—Ç–∞** ‚Äî –±–æ–ª—å—à–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ–º vector  
‚ùå **–í—Å—Ç–∞–≤–∫–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω—É** ‚Äî O(n) –∫–∞–∫ –∏ vector, –Ω–æ –±–µ–∑ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç–∏  
‚ùå **–§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞–º—è—Ç–∏** ‚Äî –±–ª–æ–∫–∏ –º–æ–≥—É—Ç —Ä–∞—Å–ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–µ –ø–æ–¥—Ä—è–¥  

---

### üí° –ó–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–∞—è –º—ã—Å–ª—å

**s21::deque** ‚Äî —ç—Ç–æ **–∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–π –∫–æ–º–ø—Ä–æ–º–∏—Å—Å** –º–µ–∂–¥—É –ø—Ä–æ—Å—Ç–æ—Ç–æ–π vector –∏ –≥–∏–±–∫–æ—Å—Ç—å—é list. –ï–≥–æ –±–ª–æ—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ:

- **O(1) –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –æ–±–æ–∏–º–∏ –∫–æ–Ω—Ü–∞–º–∏** (–∫–∞–∫ list)
- **O(1) —Å–ª—É—á–∞–π–Ω—ã–π –¥–æ—Å—Ç—É–ø** (–∫–∞–∫ vector)  
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ—Ä–æ–≥–∏—Ö —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–π** (–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –Ω–∞–¥ vector)
- **–•–æ—Ä–æ—à–∞—è –ª–æ–∫–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** (–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –Ω–∞–¥ list)

–ü–æ–Ω–∏–º–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ deque –ø–æ–º–æ–∂–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å —ç—Ç–æ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–∞–º, –≥–¥–µ –µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –¥–∞—é—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø–æ–ª—å–∑—É. –≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –≥–¥–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã.

**–ò–∑—É—á–∞–π—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ ‚Äî —ç—Ç–æ –∫–ª—é—á –∫ –Ω–∞–ø–∏—Å–∞–Ω–∏—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–¥–∞! üöÄ**

---

> üìù **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –î–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ s21::deque –≤ —Ñ–∞–π–ª–∞—Ö `src/source/headers/s21_deque.h` –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ s21_containers.